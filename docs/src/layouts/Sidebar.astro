<aside class="sidebar" role="complementary" aria-label="Sidebar" tabindex="-1">
    <nav aria-label="Sidebar navigation">
        <pc-details
            variant="outlined"
            summary="Get started"
            data-id="get-started"

        >
            <ul>
                <li>
                    <a href="/docs/get-started/installation">Installation</a>
                </li>
                <li>
                    <a href="/docs/get-started/usage">Usage</a>
                </li>
                <li>
                    <a href="/docs/get-started/customisation">Customisation</a>
                </li>
                <li>
                    <a href="/docs/get-started/form-controls">Form controls</a>
                </li>
                <li>
                    <a href="/docs/get-started/localisation">Localisation</a>
                </li>
            </ul>
        </pc-details>
        <pc-details variant="outlined" data-id="design-tokens">
            <a href="/docs/design-tokens" class="summary-link" slot="summary">
                Design tokens
            </a>

            <ul>
                <li>
                    <a href="/docs/design-tokens/borders">Borders</a>
                </li>
                <li>
                    <a href="/docs/design-tokens/colour">Colour</a>
                </li>
                <li>
                    <a href="/docs/design-tokens/focus">Focus</a>
                </li>
                <li>
                    <a href="/docs/design-tokens/shadows">Shadows</a>
                </li>
                <li>
                    <a href="/docs/design-tokens/spacing">Spacing</a>
                </li>
                <li>
                    <a href="/docs/design-tokens/transitions">Transitions</a>
                </li>
                <li>
                    <a href="/docs/design-tokens/typography">Typography</a>
                </li>
                <li>
                    <a href="/docs/design-tokens/component-groups">
                        Component groups
                    </a>
                </li>
            </ul>
        </pc-details>
        <pc-details variant="outlined" data-id="components">
            <a href="/docs/components" class="summary-link" slot="summary">
                Components
                <pc-icon library="default" icon-style="solid" name="flask"
                ></pc-icon>
            </a>

            <ul>
                <li>
                    <a href="/docs/components/animation">Animation</a>
                </li>
                <li>
                    <a href="/docs/components/avatar">Avatar</a>
                </li>
                <li>
                    <a href="/docs/components/badge">Badge</a>
                </li>
                <li>
                    <a href="/docs/components/button">Button</a>
                </li>
                <li>
                    <a href="/docs/components/button-group">Button Group</a>
                </li>
                <li>
                    <a href="/docs/components/callout">Callout</a>
                </li>
                <li>
                    <a href="/docs/components/card">Card</a>
                </li>
                <li>
                    <a href="/docs/components/checkbox">Checkbox</a>
                </li>
                <li>
                    <a href="/docs/components/color-picker">Color Picker</a>
                </li>
                <li>
                    <a href="/docs/components/comparer">Comparer</a>
                </li>
                <li>
                    <a href="/docs/components/copy-button">Copy Button</a>
                </li>
                <li>
                    <a href="/docs/components/details">Details</a>
                </li>
                <li>
                    <a href="/docs/components/dialog">Dialog</a>
                </li>
                <li>
                    <a href="/docs/components/divider">Divider</a>
                </li>
                <li>
                    <a href="/docs/components/drawer">Drawer</a>
                </li>
                <li>
                    <a href="/docs/components/dropdown">Dropdown</a>
                    <ul>
                        <li>
                            <a href="/docs/components/dropdown-item">
                                Dropdown Item
                            </a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="/docs/components/format-bytes">Format Bytes</a>
                </li>
                <li>
                    <a href="/docs/components/format-date">Format Date</a>
                </li>
                <li>
                    <a href="/docs/components/format-number">Format Number</a>
                </li>
                <li>
                    <a href="/docs/components/icon">Icon</a>
                </li>
                <li>
                    <a href="/docs/components/input">Input</a>
                </li>
                <li>
                    <a href="/docs/components/mutation-observer">
                        Mutation Observer
                    </a>
                </li>
                <li>
                    <a href="/docs/components/popup">Popup</a>
                </li>
                <li>
                    <a href="/docs/components/qr-code">QR Code</a>
                </li>
                <li>
                    <a href="/docs/components/radio-group">Radio Group</a>
                    <ul>
                        <li>
                            <a href="/docs/components/radio">Radio</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="/docs/components/rating">Rating</a>
                </li>
                <li>
                    <a href="/docs/components/resize-observer">Resize Observer</a>
                </li>
                <li>
                    <a href="/docs/components/scroller">Scroller</a>
                </li>
                <li>
                    <a href="/docs/components/select">Select</a>
                    <ul>
                        <li>
                            <a href="/docs/components/option">Option</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="/docs/components/spinner">Spinner</a>
                </li>
                <li>
                    <a href="/docs/components/switch">Switch</a>
                </li>
                <li>
                    <a href="/docs/components/tab-group">Tab Group</a>
                    <ul>
                        <li>
                            <a href="/docs/components/tab">Tab</a>
                        </li>
                        <li>
                            <a href="/docs/components/tab-panel">Tab Panel</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="/docs/components/tag">Tag</a>
                </li>
                <li>
                    <a href="/docs/components/textarea">Textarea</a>
                </li>
                <li>
                    <a href="/docs/components/tooltip">Tooltip</a>
                </li>
            </ul>
        </pc-details>
        <pc-details variant="outlined" data-id="layout">
            <a href="/docs/layout" class="summary-link" slot="summary">Layout</a>

            <ul>
                <li>
                    <a href="/docs/layout/align-items">Align items</a>
                </li>
                <li>
                    <a href="/docs/layout/cluster">Cluster</a>
                </li>
                <li>
                    <a href="/docs/layout/flank">Flank</a>
                </li>
                <li>
                    <a href="/docs/layout/frame">Frame</a>
                </li>
                <li>
                    <a href="/docs/layout/gap">Gap</a>
                </li>
                <li>
                    <a href="/docs/layout/grid">Grid</a>
                </li>
                <li>
                    <a href="/docs/layout/split">Split</a>
                </li>
                <li>
                    <a href="/docs/layout/stack">Stack</a>
                </li>
            </ul>
        </pc-details>
        <pc-details variant="outlined" data-id="style-utilities">
            <a href="/docs/style-utilities" class="summary-link" slot="summary">
                Style utilities
            </a>

            <ul>
                <li>
                    <a href="/docs/style-utilities/native-styles">Native styles</a>
                </li>
                <li>
                    <a href="/docs/style-utilities/reduce-fouce">Reduce FOUCE</a>
                </li>
                <li>
                    <a href="/docs/style-utilities/rounding">Rounding</a>
                </li>
                <li>
                    <a href="/docs/style-utilities/text">Text</a>
                </li>
                <li>
                    <a href="/docs/style-utilities/visually-hidden">
                        Visually Hidden
                    </a>
                </li>
            </ul>
        </pc-details>
        <pc-details variant="outlined" summary="Resources" data-id="resources">
            <ul>
                <li>
                    <a href="/docs/resources/community">Community</a>
                </li>
                <li>
                    <a href="/docs/resources/contributing">Contributing</a>
                </li>
                <li>
                    <a href="/docs/resources/accessibility">Accessibility</a>
                </li>
                <li>
                    <a href="/docs/resources/brand-assets">Brand assets</a>
                </li>
                <li>
                    <a href="/docs/resources/changelog">Changelog</a>
                </li>
                <li>
                    <a
                        href="https://github.com/placer-toolkit/placer-toolkit/discussions"
                    >
                        Support
                        <pc-icon
                            class="external-link"
                            library="default"
                            icon-style="solid"
                            name="arrow-up"></pc-icon>
                    </a>
                </li>
            </ul>
        </pc-details>

        <div class="other-links">
            <div class="pc-cluster">
                <button data-dialog="open contact-info">Contact</button>
                <a href="/docs/legal/privacy">Privacy</a>
                <a href="/docs/legal/code-of-conduct">Code of Conduct</a>
                <a href="/docs/legal/licence">Licence</a>
                <a href="/docs/legal/impressum">Impressum</a>
            </div>

            <span class="attribution">
                © 2025 Placer •
                <a href="https://astro.build">
                    <img
                        src="https://astro.badg.es/v2/built-with-astro/tiny.svg"
                        alt="Built with Astro"
                    />
                </a>
            </span>
        </div>
    </nav>
</aside>

<script>
    import type { PcDetails } from "placer-toolkit/dist/components/details/details.js";

    declare global {
        interface Window {
            __sidebarLinks__: string[];
        }
    }

    document.addEventListener("DOMContentLoaded", () => {
        const currentPath = window.location.pathname.replace(/\/$/, "");
        const links = document.querySelectorAll(".sidebar nav a");
        const detailsElements = document.querySelectorAll<PcDetails>(
            ".sidebar pc-details",
        );

        links.forEach((link) => {
            const href = link.getAttribute("href");
            const linkPath = href ? href.replace(/\/$/, "") : "";
            if (linkPath === currentPath) {
                link.setAttribute("aria-current", "page");
            } else {
                link.removeAttribute("aria-current");
            }
        });

        const sidebarLinks = Array.from(
            document.querySelectorAll(".sidebar pc-details a"),
        )
            .map((a) => a.getAttribute("href"))
            .filter(
                (href) =>
                    href &&
                    !href.startsWith("http") &&
                    !href.startsWith("/docs/legal"),
            );

        window.__sidebarLinks__ = sidebarLinks as string[];

        function updateSidebarState() {
            setTimeout(() => {
                const currentlyOpen = Array.from(detailsElements)
                    .filter(
                        (detail) =>
                            detail.hasAttribute("open") &&
                            detail.getAttribute("data-id"),
                    )
                    .map((detail) => detail.getAttribute("data-id"))
                    .filter((id): id is string => id !== null);
                localStorage.setItem(
                    "open-sidebar-sections",
                    JSON.stringify(currentlyOpen),
                );
            }, 0);
        }

        let isInitializing = true;

        detailsElements.forEach((element) => {
            const id = element.getAttribute("data-id");

            if (!id) {
                return;
            }

            element.addEventListener("pc-show", () => {
                if (!isInitializing) {
                    updateSidebarState();
                }
            });

            element.addEventListener("pc-hide", () => {
                if (!isInitializing) {
                    updateSidebarState();
                }
            });
        });

        try {
            const stored = localStorage.getItem("open-sidebar-sections");
            const openIds = stored ? JSON.parse(stored) : ["get-started"];

            detailsElements.forEach((element) => {
                const id = element.getAttribute("data-id");

                if (id) {
                    if (openIds.includes(id)) {
                        element.show();
                    } else {
                        element.hide();
                    }
                }
            });
        } catch (error) {
            console.warn(`Could not restore sidebar state: ${error}`);
            detailsElements.forEach((element) => {
                const id = element.getAttribute("data-id");
                if (id === "get-started") {
                    element.show();
                } else {
                    element.hide();
                }
            });
        }

        setTimeout(() => {
            isInitializing = false;
        }, 100);
    });

    const summaryLinks = document.querySelectorAll(".sidebar .summary-link");

    summaryLinks.forEach((link) => {
        link.addEventListener("click", (event) => {
            event.stopPropagation();
        });

        link.addEventListener("keydown", (event) => {
            event.stopPropagation();
        });
    });
</script>

<style>
    .sidebar {
        grid-area: sidebar;
        position: sticky;
        inset-block-start: 3.5rem;
        inset-inline-start: 0;
        padding: var(--pc-spacing-l);
        background-color: var(--pc-color-surface-default);
        border-inline-end: var(--pc-panel-border-width)
            var(--pc-panel-border-style) var(--pc-color-surface-border);
        min-inline-size: 300px;
        max-inline-size: 300px;
        block-size: calc(100dvh - 3.5rem);
        z-index: 2;
        overflow-y: auto;
    }

    .sidebar pc-details:not(:last-of-type) {
        margin-block-end: var(--pc-spacing-s);
    }

    .sidebar pc-details::part(base) {
        background-color: transparent;
    }

    .sidebar pc-details::part(summary) {
        font-weight: var(--pc-font-weight-bold);
    }

    .sidebar pc-details a[slot="summary"] {
        color: var(--pc-color-text-normal);
        text-decoration: none;
    }

    .sidebar pc-details a[slot="summary"] pc-icon {
        color: color-mix(in oklab, currentColor, var(--pc-color-mix-hover));
    }

    @media (hover: hover) {
        .sidebar pc-details a[slot="summary"]:hover {
            color: color-mix(
                in oklab,
                var(--pc-color-text-link),
                var(--pc-color-mix-hover)
            );
        }
    }

    .sidebar pc-details a[slot="summary"]:active {
        color: color-mix(
            in oklab,
            var(--pc-color-text-link),
            var(--pc-color-mix-active)
        );
    }

    .sidebar pc-details ul {
        display: flex;
        flex-direction: column;
        gap: var(--pc-spacing-s);
        margin-inline-start: var(--pc-spacing-xs);
        padding-inline-start: var(--pc-spacing-l);
        border-inline-start: var(--pc-border-width-s) var(--pc-border-style)
            var(--pc-color-neutral-border-quiet);
        list-style: none;
    }

    .sidebar pc-details > ul {
        margin-block-start: calc(-1 * var(--pc-spacing-l));
    }

    .sidebar pc-details ul li a {
        margin-inline-start: calc(
            -1 * (var(--pc-spacing-l) + var(--pc-border-width-s))
        );
        padding-inline-start: calc(
            var(--pc-spacing-l) - var(--pc-border-width-s)
        );
        color: color-mix(
            in oklab,
            var(--pc-color-text-normal),
            var(--pc-color-surface-default) 15%
        );
        border-radius: 0;
        border-inline-start: var(--pc-border-width-s) var(--pc-border-style)
            transparent;
        font-weight: var(--pc-font-weight-normal);
        text-decoration: none;
    }

    @media (hover: hover) {
        .sidebar pc-details ul li a:hover {
            color: var(--pc-color-text-normal);
            border-color: var(--pc-color-neutral-on-quiet);
        }
    }

    .sidebar pc-details ul li a:active {
        color: color-mix(
            in oklab,
            var(--pc-color-text-normal),
            var(--pc-color-mix-active)
        );
        border-color: color-mix(
            in oklab,
            var(--pc-color-neutral-on-quiet),
            var(--pc-color-mix-active)
        );
    }

    .sidebar pc-details ul li a[aria-current="page"] {
        color: var(--pc-color-primary-on-quiet);
        border-color: var(--pc-color-primary-on-quiet);
        font-weight: var(--pc-font-weight-semibold);
    }

    .sidebar pc-details ul li a pc-icon.external-link {
        margin-inline-start: var(--pc-spacing-s);
        color: var(--pc-color-text-quiet);
        rotate: 45deg;
        translate: 0 0.125rem;
    }

    .sidebar pc-details ul li ul {
        margin-block-start: var(--pc-spacing-s);
    }

    .sidebar .other-links {
        margin-block-start: var(--pc-spacing-l);
        margin-inline: var(--pc-spacing-s);
    }

    .sidebar .other-links div.pc-cluster {
        row-gap: var(--pc-spacing-xxxs);
    }

    .sidebar .other-links button {
        all: unset;
        border-radius: var(--pc-border-radius-s);
        cursor: pointer;
        transition: all var(--pc-transition-fast) ease-in-out;
    }

    .sidebar .other-links button:focus-visible {
        outline: var(--pc-focus-ring);
        outline-offset: var(--pc-focus-ring-offset);
        animation: focus-ring-animation var(--pc-transition-medium)
            cubic-bezier(0.33, 1, 0.68, 1);
    }

    .sidebar .other-links button,
    .sidebar .other-links a {
        color: var(--pc-color-neutral-on-quiet);
        font-weight: var(--pc-font-weight-semibold);
        font-size: var(--pc-font-size-smaller);
        text-decoration: none;
    }

    @media (hover: hover) {
        .sidebar .other-links button:hover,
        .sidebar .other-links a:hover {
            color: color-mix(
                in oklab,
                var(--pc-color-neutral-on-quiet),
                var(--pc-color-mix-hover)
            );
            text-decoration: var(--pc-link-decoration-hover);
        }
    }

    .sidebar .other-links button:active,
    .sidebar .other-links a:active {
        color: color-mix(
            in oklab,
            var(--pc-color-neutral-on-quiet),
            var(--pc-color-mix-active)
        );
        text-decoration: var(--pc-link-decoration-active);
    }

    :global(.pc-theme-utility)
        .sidebar
        .other-links
        :is(button, a):is(:hover, :active) {
        color: var(--pc-color-text-normal);
    }

    .sidebar .other-links .attribution {
        display: inline-block;
        align-items: center;
        margin-block-start: var(--pc-spacing-xs);
        color: var(--pc-color-neutral-on-quiet);
        font-size: var(--pc-font-size-smaller);
        font-weight: var(--pc-font-weight-medium);
    }

    .sidebar .other-links .attribution img {
        position: relative;
        inset-block-start: var(--pc-spacing-xs);
        border-radius: 0;
    }

    @media screen and (max-width: 1440px) {
        .sidebar {
            display: none;
        }
    }
</style>
